<?xml version="1.0" encoding="utf-8"?>
<i:view xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.appflower.com /schema/appflower.xsd"
	xmlns:i="http://www.appflower.com/schema/" type="edit">

	<i:title>Edit User</i:title>
	<i:datasource type="orm">
		<i:class>afGuardUserPeer</i:class>
		<i:method name="retrieveByPk">
			<i:param name="id">{id}</i:param>
		</i:method>
	</i:datasource>

	<i:fields url="/afGuardUser/update" multipart="true">
		<i:field name="id" type="hidden">
			<i:value type="orm">
				<i:source name="getId" />
			</i:value>
		</i:field>

		<i:field name="is_active" label="Is Active" type="checkbox"
			state="editable" style="css">
			<i:value type="orm">
				<i:source name="getIsActive" />
			</i:value>
			<i:tooltip>User satus</i:tooltip>
			<i:help>Current status of user</i:help>
		</i:field>

		<i:field name="username" label="Username" type="input" state="editable" style="css">
			<i:value type="orm">
				<i:source name="getUsername" />
			</i:value>
			<i:help>Username</i:help>
			<i:validator name="immValidatorUnique">
				<i:param name="class">afGuardUser</i:param>
				<i:param name="column">username</i:param>
				<i:param name="unique_error">User with the username "%value%" already
					exists. Please choose another one.</i:param>
			</i:validator>
		</i:field>

		<i:field name="guard_password" label="Password*" type="password"
			state="editable" style="css">
			<i:tooltip>Password</i:tooltip>
			<i:help>Password</i:help>
		</i:field>
		
		<i:field name="time_allocated_weekly" label="Time allocated per week" type="input" style="css">
            <i:value type="orm">          
                <i:source name="getAllocatedTimeWeekly" /> 
            </i:value>
            <i:tooltip>Time allocated per week.</i:tooltip>
            <i:help>Time allocated per week.</i:help>
            <i:validator name="immValidatorNumber" />
        </i:field>


<!--this is new-->

		<i:field name="first_name" label="First Name"
			state="editable" style="css">
			<i:value type="orm">
				<i:source name="getFirstName" />
			</i:value>
		</i:field>
		<i:field name="last_name" label="Last Name"
			state="editable" style="css">
			<i:value type="orm">
				<i:source name="getLastName" />
			</i:value>
		</i:field>
		
        <i:field name="customer_id" label="Customer" type="combo" state="editable" selected="{customer_id}" style="css">
			<i:value type="orm">
				<i:class>CustomerPeer</i:class>
				<i:method name="getAll">
				</i:method>
			</i:value>
			<i:help>The customer name</i:help>
			<i:tooltip>Select from the list the Customer.</i:tooltip>
		</i:field>
		<i:field name="job_title" label="Job Title" state="editable" style="css" value="{job_title}">
		</i:field>
		<i:field name="phone_mobile" label="Phone Mobile" state="editable"
			style="css" value="{phone_mobile}">
			<i:help>Please fill it using numbers and plus; minus chars only,
				for example: +3606-455-6789</i:help>
		</i:field>
		<i:field name="phone_office" label="Phone Office" state="editable"
			style="css" value="{phone_office}">
			<i:help>Please fill it using numbers and plus; minus chars only,
				for example: +3606-455-6789</i:help>

		</i:field>
		<i:field name="time_zones_id" type="combo" label="Timezone"
			selected="{tid}">
			<i:value type="orm">
				<i:class>TimeZonesPeer</i:class>
				<i:method name="getAll" />
			</i:value>
		</i:field>
		<i:field name="personal_body" label="About Me" type="textarea"
			state="editable" style="css" value="{personal_body}">
		</i:field>

		<i:field name="profile_picture" label="Profile picture" type="file">
		</i:field>

		<i:field name="picture" label="" type="static" value="{picture}">
		</i:field>

		<i:field name="delete_image" label="Delete Image" type="checkbox"
			state="editable" style="css" checked="0">
		</i:field>

		<i:field name="beanstalk_user" label="Beanstalk SVN user" state="editable"
			style="css" value="{beanstalk_user}">
			<i:help>Please type your SVN user, if not already automatically introduced by seedControl</i:help>
		</i:field>

	</i:fields>

	<i:actions>
		<i:action name="list" url="afGuardUser/list" />
	</i:actions>

	<i:description>
    		<![CDATA[You can add a new user or edit an existing one from this widget. ]]>
	</i:description>
	
	<i:grouping>
		<i:set title="My Profile" tabtitle="My Profile">
			<i:ref to="first_name" />
			<i:ref to="last_name" />
			<i:ref to="customer_id" />
			<i:ref to="job_title" />
			<i:ref to="phone_mobile" />
			<i:ref to="phone_office" />
			<i:ref to="time_zones_id" />
			<i:ref to="personal_body" />
		</i:set>
		<i:set title="Profile picture" tabtitle="Profile picture">
			<i:ref to="profile_picture" />
			<i:ref to="picture" />
			<i:ref to="delete_image" />
		</i:set>
		<i:set title="SVN Integration" tabtitle="SVN Integration">
			<i:ref to="beanstalk_user" />
		</i:set>
	</i:grouping>
</i:view>
